<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>ProdyScan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link
    rel="stylesheet"
    href="{{ url_for('static', filename='style.css') }}"
  />
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="logo-circle">P</div>
      <div>
        <h1>ProdyScan</h1>
        <!-- Texte dâ€™accueil masquÃ© -->
      </div>
    </header>

    <main class="app-main">
      <!-- Bloc image -->
      <section class="card">
        <h2>1. Choisir ou prendre une photo</h2>
        <p class="hint">
          Utilise de prÃ©fÃ©rence une photo bien cadrÃ©e du produit ou de son emballage.
        </p>

        <!-- Bouton que lâ€™utilisateur clique -->
        <button id="choose-btn" type="button" class="primary-btn">
          Choisir / Prendre une photo
        </button>

        <!-- Nom du fichier choisi -->
        <p id="file-name" class="file-name">Aucune image sÃ©lectionnÃ©e</p>

        <!-- Input fichier cachÃ© : ouvre appareil photo / galerie -->
        <input
          id="file-input"
          type="file"
          accept="image/*"
          hidden
        />

        <!-- AperÃ§u de lâ€™image choisie -->
        <div id="preview-wrapper" class="preview-wrapper" hidden>
          <img id="preview-img" alt="AperÃ§u de lâ€™image choisie" />
        </div>
      </section>

      <!-- Pays + boutique -->
      <div class="form-grid">
        <div class="form-group">
          <label for="country-select">Pays cible</label>
          <select id="country-select">
            <option value="global">ğŸŒ Global</option>
            <option value="civ">ğŸ‡¨ğŸ‡® CÃ´te dâ€™Ivoire</option>
            <option value="sen">ğŸ‡¸ğŸ‡³ SÃ©nÃ©gal</option>
            <option value="cmr">ğŸ‡¨ğŸ‡² Cameroun</option>
            <option value="maroc">ğŸ‡²ğŸ‡¦ Maroc</option>
            <option value="tunisie">ğŸ‡¹ğŸ‡³ Tunisie</option>
            <option value="france">ğŸ‡«ğŸ‡· France</option>
            <option value="algerie">ğŸ‡©ğŸ‡¿ AlgÃ©rie</option>
            <option value="mali">ğŸ‡²ğŸ‡± Mali</option>
          </select>
        </div>

        <div class="form-group">
          <label for="shop-select">Boutique / plateforme</label>
          <select id="shop-select">
            <!-- âš ï¸ NOUVELLE OPTION : recherche dans ton catalogue local -->
            <option value="local">ğŸ§  Catalogue local (par image)</option>

            <option value="google">ğŸ” Google (par dÃ©faut)</option>
            <option value="jumia">ğŸ›’ Jumia</option>
            <option value="amazon">ğŸ“¦ Amazon</option>
            <option value="aliexpress">ğŸ› AliExpress</option>
            <option value="ebay">ğŸŒ€ eBay</option>
            <option value="cdiscount">ğŸ‡«ğŸ‡· Cdiscount</option>
            <option value="alibaba">ğŸ­ Alibaba</option>
            <option value="custom">â­ Boutique personnalisÃ©e (champ ci-dessous)</option>
          </select>
        </div>

        <div class="form-group full-width">
          <label for="custom-shop">
            Boutique personnalisÃ©e (optionnel)
            <span class="label-hint">
              Exemple : <code>monshop.com</code> ou <code>boutiqueXYZ</code>
            </span>
          </label>
          <input
            id="custom-shop"
            type="text"
            placeholder="Nom ou domaine de ta boutique locale"
          />
        </div>
      </div>

      <!-- Bouton analyser -->
      <div class="actions-row">
        <button id="analyse-btn" class="primary">Analyser lâ€™image</button>
        <div id="loader" class="loader" hidden></div>
        <p id="error-text" class="error-text" hidden></p>
      </div>

      <!-- RÃ©sultat -->
      <section class="card" id="result-card" hidden>
        <h2>RÃ©sultat de lâ€™analyse</h2>

        <p class="result-description" id="result-description">
          Description du produitâ€¦
        </p>

        <div class="result-meta">
          <span class="badge" id="result-shop">Boutique : -</span>
          <span class="badge" id="result-country">Pays : -</span>
          <span class="badge badge-soft" id="result-source">Source : -</span>
        </div>

        <!-- Zone catalogue local -->
        <div id="local-results" class="local-results"></div>

        <!-- Lien vers boutiques externes -->
        <a id="result-link" href="#" target="_blank" class="result-link">
          Voir les offres similaires ğŸ”—
        </a>
      </section>
  <!-- Historique --> 
      <section class="card history-card">
        <div class="history-header">
          <h2>Historique rÃ©cent</h2>
          <button id="clear-history" class="link-button">Effacer</button>
        </div>
        <div id="history-list" class="history-list empty">
          <p class="history-empty">
            Aucune analyse encore. Lance ta premiÃ¨re vÃ©rification ğŸ‘‡
          </p>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      <small>
        ProdyScan â€¢ Analyse dâ€™images avec OCR
        {% if has_openai %} + OpenAI Vision{% else %}(Vision dÃ©sactivÃ©e){% endif %}
      </small>
    </footer>
  </div>

  <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>